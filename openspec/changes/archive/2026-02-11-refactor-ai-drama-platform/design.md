## Context

项目需要从一个通用的 Dashboard 模板改造为专用的短剧创作平台。短剧创作团队需要管理多个项目、跟踪进度、协作编写剧本和制作分镜头。当前项目基于 Shadcn UI + TanStack Router + Zustand，具有良好的基础架构。

### 约束条件
- 保持现有的技术栈（React、Vite、Shadcn UI）
- 暂时不集成实际的 AI 服务，但需要预留接口
- 需要支持中英文界面（当前实现中文）
- 导出功能需要客户端实现（避免依赖后端）

## Goals / Non-Goals

### Goals
- 提供完整的短剧项目管理功能
- 实现可用的分镜头编辑器
- 支持导出分镜头为常见格式
- 预留 AI 功能扩展接口
- 中文友好的用户界面

### Non-Goals
- 实时协作编辑（暂不支持）
- 复杂的权限管理系统（仅两种角色）
- 实际的 AI 服务集成（仅预留接口）
- 后端 API 开发（使用前端数据存储）

## Decisions

### 1. 数据存储策略
- **决策**: 使用 Zustand + localStorage 持久化
- **原因**: 项目暂无后端，前端本地存储足够原型使用
- **替代方案**: IndexedDB（更复杂但支持更大数据）

### 2. 路由结构重构
- **决策**: 复用现有路由布局，改造功能模块
- **原因**: 保留现有的认证、错误处理、布局组件
- **路由规划**:
  - `_authenticated/projects/` - 项目列表和详情
  - `_authenticated/projects/[id]/storyboard/` - 分镜头编辑器
  - `_authenticated/projects/[id]/script/` - 剧本编辑
  - `_authenticated/settings/` - 用户设置

### 3. 分镜头编辑器架构
- **决策**: 基于 TanStack Table 的可拖拽排序列表
- **原因**: 项目已有 DataTable 组件，可复用排序功能
- **组件设计**:
  - 镜头卡片（时间、景别、运镜、描述、对白、配图）
  - 时间轴视图
  - 缩略图网格视图

### 4. 导出功能实现
- **决策**: 使用客户端库生成 PDF/Word
- **PDF**: `jspdf` + `html2canvas`
- **Word**: `docx` 库
- **原因**: 无需后端支持，可直接导出

### 5. 国际化架构
- **决策**: 使用 `i18next` 或简单的翻译对象
- **原因**: 为未来多语言支持预留，当前仅需中文
- **实现**: 创建 `src/i18n/zh-CN.ts` 翻译文件

## Risks / Trade-offs

| 风险 | 缓解措施 |
|------|----------|
| 本地存储数据丢失风险 | 添加导入/导出 JSON 功能，定期提醒用户备份 |
| PDF/Word 导出样式问题 | 使用预定义模板，限制自定义样式 |
| 分镜头数据模型复杂度高 | 先实现 MVP，根据用户反馈迭代 |
| 性能问题（大量分镜头） | 虚拟滚动，分页加载 |

## Migration Plan

### Phase 1: 基础架构 (第 1-2 周)
1. 创建 i18n 翻译文件和上下文
2. 更新导航菜单为中文
3. 创建新的路由结构
4. 设置项目管理数据模型

### Phase 2: 项目管理 (第 3-4 周)
1. 实现项目 CRUD 界面
2. 实现团队成员管理
3. 实现进度跟踪功能
4. 实现剧本编辑器

### Phase 3: 分镜头编辑器 (第 5-6 周)
1. 实现分镜头 CRUD
2. 实现拖拽排序
3. 实现图片上传功能
4. 实现多种视图模式

### Phase 4: 导出功能 (第 7 周)
1. 实现 PDF 导出
2. 实现 Word 导出
3. 实现 JSON 导入/导出

### Phase 5: AI 接口预留 (第 8 周)
1. 定义 AI 服务接口规范
2. 创建模拟 AI 响应
3. 添加 API 配置界面

## Open Questions

1. **分镜头数据模型是否需要支持嵌套（场次/镜头）？**
   - 建议: MVP 实现扁平列表，后续支持场次分组

2. **是否需要支持多人同时编辑同一个项目？**
   - 建议: 暂不支持，添加"正在编辑"提示

3. **导出样式是否需要自定义模板？**
   - 建议: 提供 2-3 种预设模板，暂不支持自定义
