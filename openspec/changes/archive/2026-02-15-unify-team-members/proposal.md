# unify-team-members

## Why

当前团队成员管理存在以下问题：

1. **UI 不统一**：全局成员 (`/team`) 和项目成员 (`/projects/$id/team`) 使用相似的组件但代码分散
2. **用户关联缺失**：登录用户与团队成员数据分离，无法在列表中识别当前用户
3. **权限逻辑不完善**：缺乏角色层级权限控制，用户可能编辑比自己角色高的成员

## What Changes

### 1. UI 统一
- 统一全局成员和项目成员的 UI 组件
- 保持两套数据源，但共享相同的交互和样式

### 2. 登录用户关联
- 在成员列表中高亮显示当前登录用户
- 登录用户自动作为全局团队成员存在
- 用户角色同步到团队成员角色

### 3. 多租户权限模型
- `super_admin` (root@aizfl.cn): 全局超级管理员，可管理所有团队和成员
- `admin` (admin@aizfl.cn): 项目管理员，可管理项目内成员
- 其他角色：仅在项目团队内有权限

### 4. 层级权限控制
- 用户只能编辑角色低于或等于自己的成员
- 用户只能看到自己有权限的项目中的成员
- 角色优先级：super_admin > admin > director > screenwriter/editor > member

## Approach

1. 创建统一的成员列表组件 `UnifiedTeamMembers`
2. 添加当前用户标识和高亮样式
3. 实现角色层级比较函数
4. 在成员操作中增加层级权限检查

## Impact

- **用户体验**：成员管理界面更一致，当前用户位置清晰
- **安全性**：防止越权操作，确保权限层级正确
- **可维护性**：统一组件减少代码重复

## Risks

- 现有成员数据需要确认与登录用户的关联关系
- 角色映射需要与后端 API 协调

## Dependencies

- auth-store (用户角色信息)
- project-store (成员数据)
- permissions 规范
