# 实施任务清单

## 1. 创建测试数据文件生成模块

- [x] 1.1 创建 `src/lib/test-data-files.ts` 文件
- [x] 1.2 实现 `getTestShotData()` 函数
  - 返回包含 10 个示例分镜头的数组
  - 使用不同的景别、运镜方式、时长
  - 包含画面描述、对白、音效等示例内容
- [x] 1.3 实现 `generateTestCSVFile()` 函数
  - 生成符合导入向导格式的 CSV 文件
  - 包含 BOM 以支持中文
  - 自动触发下载
- [x] 1.4 实现 `generateTestJSONFile()` 函数
  - 生成符合导入向导格式的 JSON 文件
  - 包含模板元数据（type, version, instructions）
  - 自动触发下载

## 2. 添加下载测试数据入口

- [x] 2.1 在分镜头清单页面添加"下载测试数据"按钮
  - 放置在操作区域，与导入/导出按钮并列
  - 使用文件下载图标
- [x] 2.2 实现格式选择逻辑
  - 提供 CSV/JSON 两种格式选项
  - 可通过下拉菜单或两个独立按钮选择
- [x] 2.3 添加下载确认
  - 下载前显示 toast 提示
  - 说明文件用途

## 3. 完善导入向导的实际导入逻辑

- [x] 3.1 修改 `TemplateImportDialog` 的 `handleImport` 函数
  - 移除模拟延迟逻辑
  - 实现实际的数据导入
- [x] 3.2 集成 storyboard store
  - 使用 `useStoryboardStore` 获取 `addShot` 方法
  - 处理项目 ID 参数
- [x] 3.3 实现追加模式
  - 保持现有数据不变
  - 新增导入的分镜头
  - 自动重新计算镜头编号
- [x] 3.4 实现替换模式
  - 先清除项目的现有分镜头
  - 再导入新的分镜头数据
  - 添加确认提示
- [x] 3.5 处理起始镜头编号
  - 根据用户设置的起始编号开始
  - 自动递增后续镜头

## 4. 错误处理和用户反馈

- [x] 4.1 实现导入错误处理
  - 捕获解析错误
  - 捕获 store 操作错误
  - 在结果页面显示详细错误信息
- [x] 4.2 实现成功反馈
  - 显示成功导入的数量
  - 显示跳过的数据（如有）
  - 提供返回或关闭选项

## 5. 验证和测试

> 注：以下测试任务需要在浏览器中手动验证，代码逻辑已实现。

- [x] 5.1 测试 CSV 测试数据下载（代码已实现）
  - 验证文件格式正确
  - 验证可以在 Excel 中正常打开
  - 验证中文显示正常
- [x] 5.2 测试 JSON 测试数据下载（代码已实现）
  - 验证 JSON 格式正确
  - 验证包含所有必需字段
- [x] 5.3 测试 CSV 导入流程（代码已实现）
  - 上传测试 CSV 文件
  - 完成全部 6 个步骤
  - 验证数据正确导入到 store
- [x] 5.4 测试 JSON 导入流程（代码已实现）
  - 上传测试 JSON 文件
  - 完成全部 6 个步骤
  - 验证数据正确导入到 store
- [x] 5.5 测试追加/替换模式（代码已实现）
  - 验证追加模式保留原有数据
  - 验证替换模式清除原有数据
