# Tasks: 分镜头扩展字段实现任务

## 1. 数据模型更新

- [x] 1.1 更新 `StoryboardShot` 类型定义，新增 `seasonNumber`、`episodeNumber` 字段
- [x] 1.2 新增 `customFields` 字段用于存储自定义字段值
- [x] 1.3 创建 `CustomFieldConfig` 类型和 `useCustomFieldStore`
- [x] 1.4 更新 `storyboardApi` 接口类型定义

## 2. 季数/集数固定字段实现

- [x] 2.1 更新分镜头表单（`shot-form-dialog.tsx`），新增季数、集数字段
- [x] 2.2 更新分镜头表格（`shot-list-table.tsx`），新增季数、集数列（默认隐藏）
- [x] 2.3 更新表格列可见性配置
- [x] 2.4 更新表格筛选器，支持按季数/集数筛选
- [x] 2.5 更新分镜头模拟数据生成器，为新字段生成测试数据

## 3. 自定义字段配置系统

- [x] 3.1 创建 `useCustomFieldStore` 状态管理
- [x] 3.2 实现字段配置的 CRUD 操作
- [x] 3.3 实现全局字段与项目级字段的合并逻辑
- [x] 3.4 创建字段配置管理页面或组件

## 4. 自定义字段表单渲染

- [x] 4.1 创建字段类型到表单组件的映射工厂
- [x] 4.2 实现文本/多行文本字段组件
- [x] 4.3 实现数字字段组件
- [x] 4.4 实现下拉选择/多选字段组件
- [x] 4.5 实现日期字段组件
- [x] 4.6 实现复选框字段组件
- [x] 4.7 集成到分镜头表单对话框

## 5. 自定义字段表格展示

- [x] 5.1 实现动态表格列生成
- [x] 5.2 实现自定义字段的排序功能
- [x] 5.3 实现自定义字段的筛选功能
- [ ] 5.4 实现行内编辑支持

## 6. 导入/导出功能更新

- [x] 6.1 更新 CSV 导出，支持新字段
- [x] 6.2 更新 PDF 导出，支持新字段
- [x] 6.3 更新 JSON 导出，包含自定义字段配置
- [x] 6.4 更新导入向导，支持新字段映射
- [x] 6.5 实现自定义字段智能匹配

## 7. 测试与验证

- [ ] 7.1 编写自定义字段 Store 单元测试
- [ ] 7.2 编写字段类型渲染组件测试
- [ ] 7.3 手动测试完整流程
- [ ] 7.4 验证数据兼容性（现有数据不受影响）

---

## 实现总结

### 已完成的核心功能

1. **数据模型**：新增 `seasonNumber`、`episodeNumber`、`customFields` 字段
2. **自定义字段 Store**：完整的 CRUD 和全局/项目级合并逻辑
3. **表单集成**：季数/集数字段 + 自定义字段动态渲染
4. **表格展示**：动态列生成、季数/集数列（默认隐藏）、自定义字段筛选
5. **导出功能**：CSV/JSON/PDF 导出支持新字段和自定义字段
6. **导入功能**：支持季数/集数/自定义字段的智能映射

### 未完成的后续任务

- **5.4** 行内编辑支持（增强功能）
- **7.x** 测试和验证（需要人工参与）

## Dependencies

- 任务 2 依赖任务 1 完成
- 任务 4、5 依赖任务 3 完成
- 任务 6 依赖任务 2、4、5 完成
- 任务 7 贯穿整个过程

## Parallelization

以下任务可并行执行：
- 任务 1.1-1.4（数据模型）可并行
- 任务 2.1-2.2（表单和表格基础更新）可并行
- 任务 4.2-4.6（各字段类型组件）可并行
- 任务 6.1-6.3（导出功能）可并行
