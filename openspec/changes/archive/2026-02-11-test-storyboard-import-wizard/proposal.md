# 测试分镜头导入向导

## 概述

制定并执行一套完整的测试方案，使用 zai-mcp-server 工具及其他相关 MCP 工具，验证"分镜头清单"功能中"导入分镜头向导"组件的文件导入功能。

## 背景与分析

### 当前状态

分镜头导入向导 (`template-import-dialog.tsx`) 已实现以下功能：
- 6 步骤导入流程：上传文件 → 格式验证 → 字段映射 → 数据预览 → 导入选项 → 导入结果
- 支持 JSON 和 CSV 格式文件导入
- 批量导入方法 `addShots` 已实现，保留传入的镜头编号
- 文件大小验证（10MB 限制）
- JSON 解析错误处理增强
- 拖放视觉反馈改进

### 已知问题

根据 `fix-storyboard-import-wizard` 归档记录，之前存在：
- JSON 导入时步骤 6 出现 500 错误（已修复）
- 格式说明过于冗长（已简化）
- 缺少文件大小验证（已添加）

### 待验证范围

本次测试需要验证的核心功能：
1. **导入流程完整性**：所有 6 个步骤是否正常流转
2. **JSON 文件解析准确性**：数据是否正确转换为分镜头
3. **界面反馈及时性**：加载状态、错误提示、进度显示
4. **边缘情况处理**：大文件、格式错误、空文件等

## 测试目标

### 主要目标

验证 JSON 格式分镜头文件通过导入向导能够：
1. 被正确解析并识别为有效的分镜头模板
2. 在预览步骤中正确显示数据
3. 成功导入到系统的分镜头列表
4. 不出现 500 错误或其他运行时错误

### 次要目标

1. 验证错误处理的用户友好性
2. 验证界面交互的流畅性
3. 记录发现的任何问题并修复

## 变更范围

### 新增功能

1. **测试用例集合**
   - 创建标准 JSON 测试文件
   - 创建各种边缘情况测试文件（空文件、超大文件、格式错误等）

2. **自动化测试脚本**
   - 使用 Playwright MCP 工具进行 UI 自动化测试
   - 使用 zai-mcp-server 工具分析界面截图

3. **测试报告生成**
   - 生成简化测试报告
   - 记录测试结果和发现的问题

### 潜在修复

根据测试结果，可能需要修复：
1. 服务器端接口问题（如有）
2. 数据格式验证逻辑（如有）
3. 权限配置（如有）
4. 异常处理机制（如有）

## 相关规范

- `openspec/specs/storyboard/spec.md` - 分镜头编辑和导入导出相关需求
- `openspec/changes/archive/2026-02-11-fix-storyboard-import-wizard/` - 之前的修复记录

## 风险与限制

### 技术风险

1. **MCP 工具稳定性**：Playwright 和 Chrome MCP 工具可能存在兼容性问题
2. **本地环境差异**：开发服务器配置可能影响测试结果

### 测试限制

1. **时间限制**：完整的端到端测试需要较长时间
2. **浏览器差异**：仅在测试浏览器中验证，未覆盖所有浏览器

## 实施策略

采用**边测边修**策略：
1. 每项测试用例执行前记录预期结果
2. 执行测试并记录实际结果
3. 如发现问题，立即创建修复任务
4. 修复后重新测试，确保通过
5. 继续下一项测试用例

## 成功标准

### 测试成功标准

1. 所有标准 JSON 文件能成功导入
2. 错误文件能被正确识别并提示
3. 无 500 错误或未处理的异常
4. 界面交互流畅，无明显卡顿

### 修复成功标准

1. 发现的问题全部修复
2. 回归测试通过
3. 简化测试报告生成完成
